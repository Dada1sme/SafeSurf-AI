# SafeSurf AI Chrome Extension

이 폴더는 기존 SafeSurf AI 백엔드가 제공하는 URL 분석 API를 활용해 현재 브라우저 탭을 실시간으로 감시하는 크롬 웹 확장 프로그램입니다. 탭이 로드되면 확장 프로그램의 백그라운드 서비스 워커가 해당 URL을 백엔드 `/api/analyze` 엔드포인트에 전송하고, 결과가 `suspicious` 또는 `phishing`인 경우 콘텐츠 스크립트가 페이지 상단에 경고 배너를 표시해 사용자가 즉시 위험을 인지할 수 있도록 돕습니다.

## 구성 파일

| 파일 | 설명 |
| ---- | ---- |
| `manifest.json` | MV3 확장 메타데이터, 필요한 권한, 로딩할 스크립트를 정의합니다. |
| `background.js` | 활성 탭 URL을 가져와 백엔드에 분석을 요청하고, 결과를 콘텐츠/팝업 스크립트에 전달합니다. |
| `contentScript.js` | 경고 배너 UI를 주입하고 사용자 액션(무시, 페이지 나가기)을 처리합니다. |
| `config.js` | 백엔드 주소, API 경로, 캐시/타임아웃 등 확장 실행에 필요한 기본 설정을 모아둡니다. |
| `popup.html / popup.js / popup.css` | 브라우저 툴바 아이콘을 클릭했을 때 현재 탭의 최신 분석 결과를 요약해 보여줍니다. |

## 사용 방법

1. **백엔드 실행**  
   `docker-compose up backend` 등으로 SafeSurf AI FastAPI 서버를 실행해 `/api/analyze` 엔드포인트가 접근 가능하도록 합니다.

2. **설정 수정 (필요 시)**  
   기본값은 `http://localhost:8000/api/analyze`입니다. 다른 호스트나 프록시를 사용할 경우 `config.js`의 `API_BASE_URL`, `ANALYZE_ENDPOINT`를 원하는 값으로 바꾸고, `manifest.json`의 `host_permissions`에도 동일한 도메인을 추가하세요.

3. **크롬에 로드**  
   - `chrome://extensions` 진입  
   - 우측 상단 `개발자 모드` 활성화  
   - `압축해제된 확장 프로그램을 로드합니다` 클릭 후 이 `extension/` 폴더를 선택

4. **동작 확인**  
   - 임의의 웹사이트를 방문하면 확장 프로그램이 자동으로 백엔드에 URL을 전송합니다.  
   - 백엔드가 `suspicious` 또는 `phishing`을 반환하면 페이지 상단에 붉은/노란 배너가 등장해 위험 수준과 확률을 보여줍니다.  
   - 안전한 사이트를 탐색하면 배너가 자동으로 사라집니다.  
   - 브라우저 툴바에서 SafeSurf 아이콘을 클릭하면 현재 탭의 최신 분석 결과(상태, 확률, 마지막 체크 시각)를 팝업으로 확인할 수 있습니다.

## 구현 메모

- 백그라운드 스크립트는 최근 분석 결과를 5분간 캐시해 동일 사이트 이동 시 과도한 API 호출을 방지합니다.
- 콘텐츠 스크립트는 최상위 프레임에만 로드되며, 배너 `무시` 버튼으로 닫을 수 있고 `페이지 나가기`를 누르면 빈 탭으로 이동합니다.
- 네트워크 오류 발생 시에도 사용자에게 실패 사실을 알려 잠재적 위험을 방치하지 않습니다.
